/**
 * delta-controls v1.0.3 build May 31 2018
 * https://github.com/vanruesc/delta-controls
 * Copyright 2018 Raoul van RÃ¼schen, Zlib
 */

!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.DELTACONTROLS={})}(this,function(t){"use strict";var h={MOVE_FORWARD:0,MOVE_LEFT:1,MOVE_BACKWARD:2,MOVE_RIGHT:3,MOVE_DOWN:4,MOVE_UP:5,ZOOM_OUT:6,ZOOM_IN:7},o=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},i=function(){function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}}(),e=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)},s=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i},n=function(t){if(Array.isArray(t)){for(var i=0,e=Array(t.length);i<t.length;i++)e[i]=t[i];return e}return Array.from(t)},f=function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,s),this.x=t,this.y=i,this.z=e}return i(s,[{key:"set",value:function(t,i,e){return this.x=t,this.y=i,this.z=e,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}},{key:"setFromSpherical",value:function(t){var i=Math.sin(t.phi)*t.radius;return this.x=i*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=i*Math.cos(t.theta),this}},{key:"setFromCylindrical",value:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this}},{key:"setFromMatrixColumn",value:function(t,i){return this.fromArray(t.elements,4*i)}},{key:"setFromMatrixPosition",value:function(t){var i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}},{key:"setFromMatrixScale",value:function(t){var i=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=e,this.z=n,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.x/=t,this.y/=t,this.z/=t,this}},{key:"crossVectors",value:function(t,i){var e=t.x,n=t.y,s=t.z,a=i.x,r=i.y,h=i.z;return this.x=n*h-s*r,this.y=s*a-e*h,this.z=e*r-n*a,this}},{key:"cross",value:function(t){return this.crossVectors(this,t)}},{key:"transformDirection",value:function(t){var i=this.x,e=this.y,n=this.z,s=t.elements;return this.x=s[0]*i+s[4]*e+s[8]*n,this.y=s[1]*i+s[5]*e+s[9]*n,this.z=s[2]*i+s[6]*e+s[10]*n,this.normalize()}},{key:"applyMatrix3",value:function(t){var i=this.x,e=this.y,n=this.z,s=t.elements;return this.x=s[0]*i+s[3]*e+s[6]*n,this.y=s[1]*i+s[4]*e+s[7]*n,this.z=s[2]*i+s[5]*e+s[8]*n,this}},{key:"applyMatrix4",value:function(t){var i=this.x,e=this.y,n=this.z,s=t.elements;return this.x=s[0]*i+s[4]*e+s[8]*n+s[12],this.y=s[1]*i+s[5]*e+s[9]*n+s[13],this.z=s[2]*i+s[6]*e+s[10]*n+s[14],this}},{key:"applyQuaternion",value:function(t){var i=this.x,e=this.y,n=this.z,s=t.x,a=t.y,r=t.z,h=t.w,o=h*i+a*n-r*e,u=h*e+r*i-s*n,l=h*n+s*e-a*i,c=-s*i-a*e-r*n;return this.x=o*h+c*-s+u*-r-l*-a,this.y=u*h+c*-a+l*-s-o*-r,this.z=l*h+c*-r+o*-a-u*-s,this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"reflect",value:function(t){1<arguments.length&&void 0!==arguments[1]?arguments[1]:new s;var i=t.x,e=t.y,n=t.z;return this.sub(t.multiplyScalar(2*this.dot(t))),t.set(i,e,n),this}},{key:"angleTo",value:function(t){var i=this.dot(t)/Math.sqrt(this.lengthSquared()*t.lengthSquared());return Math.acos(Math.min(Math.max(i,-1),1))}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,e=this.y-t.y,n=this.z-t.z;return i*i+e*e+n*n}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}},{key:"lerpVectors",value:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}}]),s}(),a=new f,r=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f(1/0,1/0,1/0),i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f(-1/0,-1/0,-1/0);o(this,e),this.min=t,this.max=i}return i(e,[{key:"set",value:function(t,i){return this.min.copy(t),this.max.copy(i),this}},{key:"copy",value:function(t){return this.min.copy(t.min),this.max.copy(t.max),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}},{key:"getBoundingSphere",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new l;return this.getCenter(t.center),t.radius=.5*this.getSize(a).length(),t}},{key:"expandByPoint",value:function(t){return this.min.min(t),this.max.max(t),this}},{key:"expandByVector",value:function(t){return this.min.sub(t),this.max.add(t),this}},{key:"expandByScalar",value:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this}},{key:"setFromPoints",value:function(t){var i,e=void 0;for(this.min.set(0,0,0),this.max.set(0,0,0),e=0,i=t.length;e<i;++e)this.expandByPoint(t[e]);return this}},{key:"setFromCenterAndSize",value:function(t,i){var e=a.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this}},{key:"clampPoint",value:function(t){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f).copy(t).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(t){return a.copy(t).clamp(this.min,this.max).sub(t).length()}},{key:"applyMatrix4",value:function(t){var i=this.min,e=this.max;if(!this.isEmpty()){var n=t.elements,s=n[0]*i.x,a=n[1]*i.x,r=n[2]*i.x,h=n[0]*e.x,o=n[1]*e.x,u=n[2]*e.x,l=n[4]*i.y,c=n[5]*i.y,y=n[6]*i.y,v=n[4]*e.y,d=n[5]*e.y,m=n[6]*e.y,f=n[8]*i.z,x=n[9]*i.z,k=n[10]*i.z,p=n[8]*e.z,g=n[9]*e.z,M=n[10]*e.z;i.x=Math.min(s,h)+Math.min(l,v)+Math.min(f,p)+n[12],i.y=Math.min(a,o)+Math.min(c,d)+Math.min(x,g)+n[13],i.z=Math.min(r,u)+Math.min(y,m)+Math.min(k,M)+n[14],e.x=Math.max(s,h)+Math.max(l,v)+Math.max(f,p)+n[12],e.y=Math.max(a,o)+Math.max(c,d)+Math.max(x,g)+n[13],e.z=Math.max(r,u)+Math.max(y,m)+Math.max(k,M)+n[14]}return this}},{key:"translate",value:function(t){return this.min.add(t),this.max.add(t),this}},{key:"intersect",value:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(t){return this.min.min(t.min),this.max.max(t.max),this}},{key:"containsPoint",value:function(t){var i=this.min,e=this.max;return t.x>=i.x&&t.y>=i.y&&t.z>=i.z&&t.x<=e.x&&t.y<=e.y&&t.z<=e.z}},{key:"containsBox",value:function(t){var i=this.min,e=this.max,n=t.min,s=t.max;return i.x<=n.x&&s.x<=e.x&&i.y<=n.y&&s.y<=e.y&&i.z<=n.z&&s.z<=e.z}},{key:"intersectsBox",value:function(t){var i=this.min,e=this.max,n=t.min,s=t.max;return s.x>=i.x&&s.y>=i.y&&s.z>=i.z&&n.x<=e.x&&n.y<=e.y&&n.z<=e.z}},{key:"intersectsSphere",value:function(t){return this.clampPoint(t.center,a).distanceToSquared(t.center)<=t.radius*t.radius}},{key:"intersectsPlane",value:function(t){var i=void 0,e=void 0;return 0<t.normal.x?(i=t.normal.x*this.min.x,e=t.normal.x*this.max.x):(i=t.normal.x*this.max.x,e=t.normal.x*this.min.x),0<t.normal.y?(i+=t.normal.y*this.min.y,e+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,e+=t.normal.y*this.min.y),0<t.normal.z?(i+=t.normal.z*this.min.z,e+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,e+=t.normal.z*this.min.z),i<=t.constant&&e>=t.constant}},{key:"equals",value:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}]),e}(),u=new r,l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.center=t,this.radius=i}return i(e,[{key:"set",value:function(t,i){return this.center.copy(t),this.radius=i,this}},{key:"copy",value:function(t){return this.center.copy(t.center),this.radius=t.radius,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"setFromPoints",value:function(t){var i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:u.setFromPoints(t).getCenter(this.center),n=0,s=void 0;for(s=0,i=t.length;s<i;++s)n=Math.max(n,e.distanceToSquared(t[s]));return this.radius=Math.sqrt(n),this}},{key:"getBoundingBox",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new r;return t.set(this.center,this.center),t.expandByScalar(this.radius),t}},{key:"isEmpty",value:function(){return this.radius<=0}},{key:"translate",value:function(t){return this.center.add(t),this}},{key:"clampPoint",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f,e=this.center.distanceToSquared(t);return i.copy(t),e>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}},{key:"distanceToPoint",value:function(t){return t.distanceTo(this.center)-this.radius}},{key:"containsPoint",value:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"intersectsSphere",value:function(t){var i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}},{key:"intersectsBox",value:function(t){return t.intersectsSphere(this)}},{key:"intersectsPlane",value:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}},{key:"equals",value:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}]),e}(),c=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.x=t,this.y=i}return i(e,[{key:"set",value:function(t,i){return this.x=t,this.y=i,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divideScalar",value:function(t){return this.x/=t,this.y/=t,this}},{key:"applyMatrix3",value:function(t){var i=this.x,e=this.y,n=t.elements;return this.x=n[0]*i+n[3]*e+n[6],this.y=n[1]*i+n[4]*e+n[7],this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"angle",value:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this}},{key:"lerpVectors",value:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)}},{key:"rotateAround",value:function(t,i){var e=Math.cos(i),n=Math.sin(i),s=this.x-t.x,a=this.y-t.y;return this.x=s*e-a*n+t.x,this.y=s*n+a*e+t.y,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"width",get:function(){return this.x},set:function(t){return this.x=t}},{key:"height",get:function(){return this.y},set:function(t){return this.y=t}}]),e}(),y=new c,v=(function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new c(1/0,1/0),i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new c(-1/0,-1/0);o(this,e),this.min=t,this.max=i}i(e,[{key:"set",value:function(t,i){return this.min.copy(t),this.max.copy(i),this}},{key:"copy",value:function(t){return this.min.copy(t.min),this.max.copy(t.max),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new c;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new c;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}},{key:"getBoundingSphere",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new l;return this.getCenter(t.center),t.radius=.5*this.getSize(y).length(),t}},{key:"expandByPoint",value:function(t){return this.min.min(t),this.max.max(t),this}},{key:"expandByVector",value:function(t){return this.min.sub(t),this.max.add(t),this}},{key:"expandByScalar",value:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this}},{key:"setFromPoints",value:function(t){var i,e=void 0;for(this.min.set(0,0),this.max.set(0,0),e=0,i=t.length;e<i;++e)this.expandByPoint(t[e]);return this}},{key:"setFromCenterAndSize",value:function(t,i){var e=y.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this}},{key:"clampPoint",value:function(t){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:new c).copy(t).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(t){return y.copy(t).clamp(this.min,this.max).sub(t).length()}},{key:"translate",value:function(t){return this.min.add(t),this.max.add(t),this}},{key:"intersect",value:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(t){return this.min.min(t.min),this.max.max(t.max),this}},{key:"containsPoint",value:function(t){var i=this.min,e=this.max;return t.x>=i.x&&t.y>=i.y&&t.x<=e.x&&t.y<=e.y}},{key:"containsBox",value:function(t){var i=this.min,e=this.max,n=t.min,s=t.max;return i.x<=n.x&&s.x<=e.x&&i.y<=n.y&&s.y<=e.y}},{key:"intersectsBox",value:function(t){var i=this.min,e=this.max,n=t.min,s=t.max;return s.x>=i.x&&s.y>=i.y&&n.x<=e.x&&n.y<=e.y}},{key:"equals",value:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}])}(),function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,n),this.radius=t,this.theta=i,this.y=e}i(n,[{key:"set",value:function(t,i,e){return this.radius=t,this.theta=i,this.y=e,this}},{key:"copy",value:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"setFromVector3",value:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}])}(),function(){function t(){o(this,t),this.elements=new Float32Array([1,0,0,0,1,0,0,0,1])}return i(t,[{key:"set",value:function(t,i,e,n,s,a,r,h,o){var u=this.elements;return u[0]=t,u[3]=i,u[6]=e,u[1]=n,u[4]=s,u[7]=a,u[2]=r,u[5]=h,u[8]=o,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(t){var i=t.elements,e=this.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this.elements,n=void 0;for(n=0;n<9;++n)e[n]=t[n+i];return this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this.elements,n=void 0;for(n=0;n<9;++n)t[n+i]=e[n];return t}},{key:"multiplyMatrices",value:function(t,i){var e=t.elements,n=i.elements,s=this.elements,a=e[0],r=e[3],h=e[6],o=e[1],u=e[4],l=e[7],c=e[2],y=e[5],v=e[8],d=n[0],m=n[3],f=n[6],x=n[1],k=n[4],p=n[7],g=n[2],M=n[5],z=n[8];return s[0]=a*d+r*x+h*g,s[3]=a*m+r*k+h*M,s[6]=a*f+r*p+h*z,s[1]=o*d+u*x+l*g,s[4]=o*m+u*k+l*M,s[7]=o*f+u*p+l*z,s[2]=c*d+y*x+v*g,s[5]=c*m+y*k+v*M,s[8]=c*f+y*p+v*z,this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyScalar",value:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this}},{key:"determinant",value:function(){var t=this.elements,i=t[0],e=t[1],n=t[2],s=t[3],a=t[4],r=t[5],h=t[6],o=t[7],u=t[8];return i*a*u-i*r*o-e*s*u+e*r*h+n*s*o-n*a*h}},{key:"getInverse",value:function(t){var i=t.elements,e=this.elements,n=i[0],s=i[1],a=i[2],r=i[3],h=i[4],o=i[5],u=i[6],l=i[7],c=i[8],y=c*h-o*l,v=o*u-c*r,d=l*r-h*u,m=n*y+s*v+a*d,f=void 0;return 0!==m?(f=1/m,e[0]=y*f,e[1]=(a*l-c*s)*f,e[2]=(o*s-a*h)*f,e[3]=v*f,e[4]=(c*n-a*u)*f,e[5]=(a*r-o*n)*f,e[6]=d*f,e[7]=(s*u-l*n)*f,e[8]=(h*n-s*r)*f):(console.error("Can't invert matrix, determinant is zero",t),this.identity()),this}},{key:"transpose",value:function(){var t=this.elements,i=void 0;return i=t[1],t[1]=t[3],t[3]=i,i=t[2],t[2]=t[6],t[6]=i,i=t[5],t[5]=t[7],t[7]=i,this}},{key:"scale",value:function(t,i){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=i,e[4]*=i,e[7]*=i,this}},{key:"rotate",value:function(t){var i=Math.cos(t),e=Math.sin(t),n=this.elements,s=n[0],a=n[3],r=n[6],h=n[1],o=n[4],u=n[7];return n[0]=i*s+e*h,n[3]=i*a+e*o,n[6]=i*r+e*u,n[1]=-e*s+i*h,n[4]=-e*a+i*o,n[7]=-e*r+i*u,this}},{key:"translate",value:function(t,i){var e=this.elements;return e[0]+=t*e[2],e[3]+=t*e[5],e[6]+=t*e[8],e[1]+=i*e[2],e[4]+=i*e[5],e[7]+=i*e[8],this}},{key:"equals",value:function(t){var i=this.elements,e=t.elements,n=!0,s=void 0;for(s=0;n&&s<9;++s)i[s]!==e[s]&&(n=!1);return n}}]),t}()),w="XYZ",b="YZX",A="ZXY",S="XZY",P="YXZ",E="ZYX",d=new f,m=function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;o(this,s),this.x=t,this.y=i,this.z=e,this.w=n}return i(s,[{key:"set",value:function(t,i,e,n){return this.x=t,this.y=i,this.z=e,this.w=n,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t}},{key:"setFromEuler",value:function(t){var i=t.x,e=t.y,n=t.z,s=Math.cos,a=Math.sin,r=s(i/2),h=s(e/2),o=s(n/2),u=a(i/2),l=a(e/2),c=a(n/2);switch(t.order){case w:this.x=u*h*o+r*l*c,this.y=r*l*o-u*h*c,this.z=r*h*c+u*l*o,this.w=r*h*o-u*l*c;break;case P:this.x=u*h*o+r*l*c,this.y=r*l*o-u*h*c,this.z=r*h*c-u*l*o,this.w=r*h*o+u*l*c;break;case A:this.x=u*h*o-r*l*c,this.y=r*l*o+u*h*c,this.z=r*h*c+u*l*o,this.w=r*h*o-u*l*c;break;case E:this.x=u*h*o-r*l*c,this.y=r*l*o+u*h*c,this.z=r*h*c-u*l*o,this.w=r*h*o+u*l*c;break;case b:this.x=u*h*o+r*l*c,this.y=r*l*o+u*h*c,this.z=r*h*c-u*l*o,this.w=r*h*o-u*l*c;break;case S:this.x=u*h*o-r*l*c,this.y=r*l*o-u*h*c,this.z=r*h*c+u*l*o,this.w=r*h*o+u*l*c}return this}},{key:"setFromAxisAngle",value:function(t,i){var e=i/2,n=Math.sin(e);return this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(e),this}},{key:"setFromRotationMatrix",value:function(t){var i=t.elements,e=i[0],n=i[4],s=i[8],a=i[1],r=i[5],h=i[9],o=i[2],u=i[6],l=i[10],c=e+r+l,y=void 0;return 0<c?(y=.5/Math.sqrt(c+1),this.w=.25/y,this.x=(u-h)*y,this.y=(s-o)*y,this.z=(a-n)*y):r<e&&l<e?(y=2*Math.sqrt(1+e-r-l),this.w=(u-h)/y,this.x=.25*y,this.y=(n+a)/y,this.z=(s+o)/y):l<r?(y=2*Math.sqrt(1+r-e-l),this.w=(s-o)/y,this.x=(n+a)/y,this.y=.25*y,this.z=(h+u)/y):(y=2*Math.sqrt(1+l-e-r),this.w=(a-n)/y,this.x=(s+o)/y,this.y=(h+u)/y,this.z=.25*y),this}},{key:"setFromUnitVectors",value:function(t,i){var e=t.dot(i)+1;return e<1e-6?(e=0,Math.abs(t.x)>Math.abs(t.z)?d.set(-t.y,t.x,0):d.set(0,-t.z,t.y)):d.crossVectors(t,i),this.x=d.x,this.y=d.y,this.z=d.z,this.w=e,this.normalize()}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"normalize",value:function(){var t=this.length(),i=void 0;return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(i=1/t,this.x=this.x*i,this.y=this.y*i,this.z=this.z*i,this.w=this.w*i),this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},{key:"multiplyQuaternions",value:function(t,i){var e=t.x,n=t.y,s=t.z,a=t.w,r=i.x,h=i.y,o=i.z,u=i.w;return this.x=e*u+a*r+n*o-s*h,this.y=n*u+a*h+s*r-e*o,this.z=s*u+a*o+e*h-n*r,this.w=a*u-e*r-n*h-s*o,this}},{key:"multiply",value:function(t){return this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"slerp",value:function(t,i){var e=this.x,n=this.y,s=this.z,a=this.w,r=void 0,h=void 0,o=void 0,u=void 0,l=void 0;if(1===i)this.copy(t);else if(0<i){if((r=a*t.w+e*t.x+n*t.y+s*t.z)<0?(this.w=-t.w,this.x=-t.x,this.y=-t.y,this.z=-t.z,r=-r):this.copy(t),1<=r)return this.w=a,this.x=e,this.y=n,this.z=s,this;if(h=Math.sqrt(1-r*r),Math.abs(h)<.001)return this.w=.5*(a+this.w),this.x=.5*(e+this.x),this.y=.5*(n+this.y),this.z=.5*(s+this.z),this;o=Math.atan2(h,r),u=Math.sin((1-i)*o)/h,l=Math.sin(i*o)/h,this.w=a*u+this.w*l,this.x=e*u+this.x*l,this.y=n*u+this.y*l,this.z=s*u+this.z*l}return this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}}],[{key:"slerp",value:function(t,i,e,n){return e.copy(t).slerp(i,n)}},{key:"slerpFlat",value:function(t,i,e,n,s,a,r){var h=s[a],o=s[a+1],u=s[a+2],l=s[a+3],c=e[n],y=e[n+1],v=e[n+2],d=e[n+3],m=void 0,f=void 0,x=void 0,k=void 0,p=void 0,g=void 0,M=void 0,z=void 0;d===l&&c===h&&y===o&&v===u||(m=1-r,g=0<=(k=c*h+y*o+v*u+d*l)?1:-1,(p=1-k*k)>Number.EPSILON&&(x=Math.sqrt(p),M=Math.atan2(x,k*g),m=Math.sin(m*M)/x,r=Math.sin(r*M)/x),c=c*m+h*(z=r*g),y=y*m+o*z,v=v*m+u*z,d=d*m+l*z,m===1-r&&(c*=f=1/Math.sqrt(c*c+y*y+v*v+d*d),y*=f,v*=f,d*=f)),t[i]=c,t[i+1]=y,t[i+2]=v,t[i+3]=d}}]),s}();function x(t,i,e){return Math.max(Math.min(t,e),i)}var k=new v,p=new m,g=(function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,n),this.x=t,this.y=i,this.z=e,this.order=n.defaultOrder}i(n,[{key:"set",value:function(t,i,e,n){return this.x=t,this.y=i,this.z=e,this.order=n,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.order=t.order,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.order)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.order=t[i+3],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.order,t}},{key:"toVector3",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f).set(this.x,this.y,this.z)}},{key:"setFromRotationMatrix",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.order,e=t.elements,n=e[0],s=e[4],a=e[8],r=e[1],h=e[5],o=e[9],u=e[2],l=e[6],c=e[10],y=.99999;switch(i){case w:this.y=Math.asin(x(a,-1,1)),Math.abs(a)<y?(this.x=Math.atan2(-o,c),this.z=Math.atan2(-s,n)):(this.x=Math.atan2(l,h),this.z=0);break;case P:this.x=Math.asin(-x(o,-1,1)),Math.abs(o)<y?(this.y=Math.atan2(a,c),this.z=Math.atan2(r,h)):(this.y=Math.atan2(-u,n),this.z=0);break;case A:this.x=Math.asin(x(l,-1,1)),Math.abs(l)<y?(this.y=Math.atan2(-u,c),this.z=Math.atan2(-s,h)):(this.y=0,this.z=Math.atan2(r,n));break;case E:this.y=Math.asin(-x(u,-1,1)),Math.abs(u)<y?(this.x=Math.atan2(l,c),this.z=Math.atan2(r,n)):(this.x=0,this.z=Math.atan2(-s,h));break;case b:this.z=Math.asin(x(r,-1,1)),Math.abs(r)<y?(this.x=Math.atan2(-o,h),this.y=Math.atan2(-u,n)):(this.x=0,this.y=Math.atan2(a,c));break;case S:this.z=Math.asin(-x(s,-1,1)),Math.abs(s)<y?(this.x=Math.atan2(l,h),this.y=Math.atan2(a,n)):(this.x=Math.atan2(-o,c),this.y=0)}return this.order=i,this}},{key:"setFromQuaternion",value:function(t,i){return k.makeRotationFromQuaternion(t),this.setFromRotationMatrix(k,i)}},{key:"setFromVector3",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.order;return this.set(t.x,t.y,t.z,i)}},{key:"reorder",value:function(t){return p.setFromEuler(this),this.setFromQuaternion(p,t)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.order===this.order}}],[{key:"defaultOrder",get:function(){return w}}])}(),new f),M=new f,z=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f(1,0,0),i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.normal=t,this.constant=i}return i(e,[{key:"set",value:function(t,i){return this.normal.copy(t),this.constant=i,this}},{key:"setComponents",value:function(t,i,e,n){return this.normal.set(t,i,e),this.constant=n,this}},{key:"copy",value:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"setFromNormalAndCoplanarPoint",value:function(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(t,i,e){var n=g.subVectors(e,i).cross(M.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(n,g),this}},{key:"normalize",value:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}},{key:"negate",value:function(){return this.normal.negate(),this.constant=-this.constant,this}},{key:"distanceToPoint",value:function(t){return this.normal.dot(t)+this.constant}},{key:"distanceToSphere",value:function(t){return this.distanceToPoint(t.center)-t.radius}},{key:"projectPoint",value:function(t,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}},{key:"coplanarPoint",value:function(t){return t.copy(this.normal).multiplyScalar(-this.constant)}},{key:"translate",value:function(t){return this.constant-=t.dot(this.normal),this}},{key:"intersectLine",value:function(t,i){var e=t.delta(g),n=this.normal.dot(e);if(0===n)0===this.distanceToPoint(t.start)&&i.copy(t.start);else{var s=-(t.start.dot(this.normal)+this.constant)/n;0<=s&&s<=1&&i.copy(e).multiplyScalar(s).add(t.start)}return i}},{key:"intersectsLine",value:function(t){var i=this.distanceToPoint(t.start),e=this.distanceToPoint(t.end);return i<0&&0<e||e<0&&0<i}},{key:"intersectsBox",value:function(t){return t.intersectsPlane(this)}},{key:"intersectsSphere",value:function(t){return t.intersectsPlane(this)}},{key:"equals",value:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}]),e}(),T=new f,O=new f,q=(function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new z,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new z,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new z,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new z,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:new z,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:new z;o(this,r),this.planes=[t,i,e,n,s,a]}i(r,[{key:"set",value:function(t,i,e,n,s,a){var r=this.planes;return r[0].copy(t),r[1].copy(i),r[2].copy(e),r[3].copy(n),r[4].copy(s),r[5].copy(a),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){var i=this.planes,e=void 0;for(e=0;e<6;++e)i[e].copy(t.planes[e]);return this}},{key:"setFromMatrix",value:function(t){var i=this.planes,e=t.elements,n=e[0],s=e[1],a=e[2],r=e[3],h=e[4],o=e[5],u=e[6],l=e[7],c=e[8],y=e[9],v=e[10],d=e[11],m=e[12],f=e[13],x=e[14],k=e[15];return i[0].setComponents(r-n,l-h,d-c,k-m).normalize(),i[1].setComponents(r+n,l+h,d+c,k+m).normalize(),i[2].setComponents(r+s,l+o,d+y,k+f).normalize(),i[3].setComponents(r-s,l-o,d-y,k-f).normalize(),i[4].setComponents(r-a,l-u,d-v,k-x).normalize(),i[5].setComponents(r+a,l+u,d+v,k+x).normalize(),this}},{key:"intersectsSphere",value:function(t){var i=this.planes,e=t.center,n=-t.radius,s=!0,a=void 0;for(a=0;a<6;++a)if(i[a].distanceToPoint(e)<n){s=!1;break}return s}},{key:"intersectsBox",value:function(t){var i=this.planes,e=t.min,n=t.max,s=!0,a=void 0,r=void 0,h=void 0,o=void 0;for(a=0;a<6;++a)if(o=i[a],T.x=0<o.normal.x?e.x:n.x,O.x=0<o.normal.x?n.x:e.x,T.y=0<o.normal.y?e.y:n.y,O.y=0<o.normal.y?n.y:e.y,T.z=0<o.normal.z?e.z:n.z,O.z=0<o.normal.z?n.z:e.z,r=o.distanceToPoint(T),h=o.distanceToPoint(O),r<0&&h<0){s=!1;break}return s}},{key:"containsPoint",value:function(t){var i=this.planes,e=!0,n=void 0;for(n=0;n<6;++n)if(i[n].distanceToPoint(t)<0){e=!1;break}return e}}])}(),new f),F=new f,V=(function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f;o(this,e),this.start=t,this.end=i}i(e,[{key:"set",value:function(t,i){return this.start.copy(t),this.end.copy(i),this}},{key:"copy",value:function(t){return this.start.copy(t.start),this.end.copy(t.end),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"getCenter",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f).subVectors(this.end,this.start)}},{key:"lengthSquared",value:function(){return this.start.distanceToSquared(this.end)}},{key:"length",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(t,i){return this.delta(i).multiplyScalar(t).add(this.start)}},{key:"closestPointToPointParameter",value:function(t,i){q.subVectors(t,this.start),F.subVectors(this.end,this.start);var e=F.dot(F),n=F.dot(q);return i?Math.min(Math.max(n/e,0),1):n/e}},{key:"closestPointToPoint",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new f,n=this.closestPointToPointParameter(t,i);return this.delta(e).multiplyScalar(n).add(this.start)}},{key:"equals",value:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}])}(),new f),L=new f,D=new f,C=function(){function t(){o(this,t),this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return i(t,[{key:"set",value:function(t,i,e,n,s,a,r,h,o,u,l,c,y,v,d,m){var f=this.elements;return f[0]=t,f[4]=i,f[8]=e,f[12]=n,f[1]=s,f[5]=a,f[9]=r,f[13]=h,f[2]=o,f[6]=u,f[10]=l,f[14]=c,f[3]=y,f[7]=v,f[11]=d,f[15]=m,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"copy",value:function(t){var i=t.elements,e=this.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this.elements,n=void 0;for(n=0;n<16;++n)e[n]=t[n+i];return this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this.elements,n=void 0;for(n=0;n<16;++n)t[n+i]=e[n];return t}},{key:"getMaxScaleOnAxis",value:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,e,n))}},{key:"copyPosition",value:function(t){var i=this.elements,e=t.elements;return i[12]=e[12],i[13]=e[13],i[14]=e[14],this}},{key:"setPosition",value:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this}},{key:"extractBasis",value:function(t,i,e){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(t,i,e){return this.set(t.x,i.x,e.x,0,t.y,i.y,e.y,0,t.z,i.z,e.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(t){var i=this.elements,e=t.elements,n=1/V.setFromMatrixColumn(t,0).length(),s=1/V.setFromMatrixColumn(t,1).length(),a=1/V.setFromMatrixColumn(t,2).length();return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=0,i[4]=e[4]*s,i[5]=e[5]*s,i[6]=e[6]*s,i[7]=0,i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}},{key:"makeRotationFromEuler",value:function(t){var i=this.elements,e=t.x,n=t.y,s=t.z,a=Math.cos(e),r=Math.sin(e),h=Math.cos(n),o=Math.sin(n),u=Math.cos(s),l=Math.sin(s),c=void 0,y=void 0,v=void 0,d=void 0,m=void 0,f=void 0,x=void 0,k=void 0,p=void 0,g=void 0,M=void 0,z=void 0;switch(t.order){case w:c=a*u,y=a*l,v=r*u,d=r*l,i[0]=h*u,i[4]=-h*l,i[8]=o,i[1]=y+v*o,i[5]=c-d*o,i[9]=-r*h,i[2]=d-c*o,i[6]=v+y*o,i[10]=a*h;break;case P:m=h*u,f=h*l,x=o*u,k=o*l,i[0]=m+k*r,i[4]=x*r-f,i[8]=a*o,i[1]=a*l,i[5]=a*u,i[9]=-r,i[2]=f*r-x,i[6]=k+m*r,i[10]=a*h;break;case A:m=h*u,f=h*l,x=o*u,k=o*l,i[0]=m-k*r,i[4]=-a*l,i[8]=x+f*r,i[1]=f+x*r,i[5]=a*u,i[9]=k-m*r,i[2]=-a*o,i[6]=r,i[10]=a*h;break;case E:c=a*u,y=a*l,v=r*u,d=r*l,i[0]=h*u,i[4]=v*o-y,i[8]=c*o+d,i[1]=h*l,i[5]=d*o+c,i[9]=y*o-v,i[2]=-o,i[6]=r*h,i[10]=a*h;break;case b:p=a*h,g=a*o,M=r*h,z=r*o,i[0]=h*u,i[4]=z-p*l,i[8]=M*l+g,i[1]=l,i[5]=a*u,i[9]=-r*u,i[2]=-o*u,i[6]=g*l+M,i[10]=p-z*l;break;case S:p=a*h,g=a*o,M=r*h,z=r*o,i[0]=h*u,i[4]=-l,i[8]=o*u,i[1]=p*l+z,i[5]=a*u,i[9]=g*l-M,i[2]=M*l-g,i[6]=r*u,i[10]=z*l+p}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(t){return this.compose(V.set(0,0,0),t,L.set(1,1,1))}},{key:"lookAt",value:function(t,i,e){var n=this.elements,s=V,a=L,r=D;return r.subVectors(t,i),0===r.lengthSquared()&&(r.z=1),r.normalize(),s.crossVectors(e,r),0===s.lengthSquared()&&(1===Math.abs(e.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),s.crossVectors(e,r)),s.normalize(),a.crossVectors(r,s),n[0]=s.x,n[4]=a.x,n[8]=r.x,n[1]=s.y,n[5]=a.y,n[9]=r.y,n[2]=s.z,n[6]=a.z,n[10]=r.z,this}},{key:"multiplyMatrices",value:function(t,i){var e=this.elements,n=t.elements,s=i.elements,a=n[0],r=n[4],h=n[8],o=n[12],u=n[1],l=n[5],c=n[9],y=n[13],v=n[2],d=n[6],m=n[10],f=n[14],x=n[3],k=n[7],p=n[11],g=n[15],M=s[0],z=s[4],w=s[8],b=s[12],A=s[1],S=s[5],P=s[9],E=s[13],T=s[2],O=s[6],q=s[10],F=s[14],V=s[3],L=s[7],D=s[11],C=s[15];return e[0]=a*M+r*A+h*T+o*V,e[4]=a*z+r*S+h*O+o*L,e[8]=a*w+r*P+h*q+o*D,e[12]=a*b+r*E+h*F+o*C,e[1]=u*M+l*A+c*T+y*V,e[5]=u*z+l*S+c*O+y*L,e[9]=u*w+l*P+c*q+y*D,e[13]=u*b+l*E+c*F+y*C,e[2]=v*M+d*A+m*T+f*V,e[6]=v*z+d*S+m*O+f*L,e[10]=v*w+d*P+m*q+f*D,e[14]=v*b+d*E+m*F+f*C,e[3]=x*M+k*A+p*T+g*V,e[7]=x*z+k*S+p*O+g*L,e[11]=x*w+k*P+p*q+g*D,e[15]=x*b+k*E+p*F+g*C,this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyScalar",value:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}},{key:"determinant",value:function(){var t=this.elements,i=t[0],e=t[4],n=t[8],s=t[12],a=t[1],r=t[5],h=t[9],o=t[13],u=t[2],l=t[6],c=t[10],y=t[14],v=i*r,d=i*h,m=i*o,f=e*a,x=e*h,k=e*o,p=n*a,g=n*r,M=n*o,z=s*a,w=s*r,b=s*h;return t[3]*(b*l-M*l-w*c+k*c+g*y-x*y)+t[7]*(d*y-m*c+z*c-p*y+M*u-b*u)+t[11]*(m*l-v*y-z*l+f*y+w*u-k*u)+t[15]*(-g*u-d*l+v*c+p*l-f*c+x*u)}},{key:"getInverse",value:function(t){var i=this.elements,e=t.elements,n=e[0],s=e[1],a=e[2],r=e[3],h=e[4],o=e[5],u=e[6],l=e[7],c=e[8],y=e[9],v=e[10],d=e[11],m=e[12],f=e[13],x=e[14],k=e[15],p=y*x*l-f*v*l+f*u*d-o*x*d-y*u*k+o*v*k,g=m*v*l-c*x*l-m*u*d+h*x*d+c*u*k-h*v*k,M=c*f*l-m*y*l+m*o*d-h*f*d-c*o*k+h*y*k,z=m*y*u-c*f*u-m*o*v+h*f*v+c*o*x-h*y*x,w=n*p+s*g+a*M+r*z,b=void 0;return 0!==w?(b=1/w,i[0]=p*b,i[1]=(f*v*r-y*x*r-f*a*d+s*x*d+y*a*k-s*v*k)*b,i[2]=(o*x*r-f*u*r+f*a*l-s*x*l-o*a*k+s*u*k)*b,i[3]=(y*u*r-o*v*r-y*a*l+s*v*l+o*a*d-s*u*d)*b,i[4]=g*b,i[5]=(c*x*r-m*v*r+m*a*d-n*x*d-c*a*k+n*v*k)*b,i[6]=(m*u*r-h*x*r-m*a*l+n*x*l+h*a*k-n*u*k)*b,i[7]=(h*v*r-c*u*r+c*a*l-n*v*l-h*a*d+n*u*d)*b,i[8]=M*b,i[9]=(m*y*r-c*f*r-m*s*d+n*f*d+c*s*k-n*y*k)*b,i[10]=(h*f*r-m*o*r+m*s*l-n*f*l-h*s*k+n*o*k)*b,i[11]=(c*o*r-h*y*r-c*s*l+n*y*l+h*s*d-n*o*d)*b,i[12]=z*b,i[13]=(c*f*a-m*y*a+m*s*v-n*f*v-c*s*x+n*y*x)*b,i[14]=(m*o*a-h*f*a-m*s*u+n*f*u+h*s*x-n*o*x)*b,i[15]=(h*y*a-c*o*a+c*s*u-n*y*u-h*s*v+n*o*v)*b):(console.error("Can't invert matrix, determinant is zero",t),this.identity()),this}},{key:"transpose",value:function(){var t=this.elements,i=void 0;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}},{key:"scale",value:function(t,i,e){var n=this.elements;return n[0]*=t,n[4]*=i,n[8]*=e,n[1]*=t,n[5]*=i,n[9]*=e,n[2]*=t,n[6]*=i,n[10]*=e,n[3]*=t,n[7]*=i,n[11]*=e,this}},{key:"makeScale",value:function(t,i,e){return this.set(t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1),this}},{key:"makeTranslation",value:function(t,i,e){return this.set(1,0,0,t,0,1,0,i,0,0,1,e,0,0,0,1),this}},{key:"makeRotationX",value:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,i,-e,0,0,e,i,0,0,0,0,1),this}},{key:"makeRotationY",value:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,0,e,0,0,1,0,0,-e,0,i,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,-e,0,0,e,i,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(t,i){var e=Math.cos(i),n=Math.sin(i),s=1-e,a=t.x,r=t.y,h=t.z,o=s*a,u=s*r;return this.set(o*a+e,o*r-n*h,o*h+n*r,0,o*r+n*h,u*r+e,u*h-n*a,0,o*h-n*r,u*h+n*a,s*h*h+e,0,0,0,0,1),this}},{key:"makeShear",value:function(t,i,e){return this.set(1,i,e,0,t,1,e,0,t,i,1,0,0,0,0,1),this}},{key:"compose",value:function(t,i,e){var n=this.elements,s=i.x,a=i.y,r=i.z,h=i.w,o=s+s,u=a+a,l=r+r,c=s*o,y=s*u,v=s*l,d=a*u,m=a*l,f=r*l,x=h*o,k=h*u,p=h*l,g=e.x,M=e.y,z=e.z;return n[0]=(1-(d+f))*g,n[1]=(y+p)*g,n[2]=(v-k)*g,n[3]=0,n[4]=(y-p)*M,n[5]=(1-(c+f))*M,n[6]=(m+x)*M,n[7]=0,n[8]=(v+k)*z,n[9]=(m-x)*z,n[10]=(1-(c+d))*z,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}},{key:"decompose",value:function(t,i,e){var n=this.elements,s=n[0],a=n[1],r=n[2],h=n[4],o=n[5],u=n[6],l=n[8],c=n[9],y=n[10],v=this.determinant(),d=V.set(s,a,r).length()*(v<0?-1:1),m=V.set(h,o,u).length(),f=V.set(l,c,y).length(),x=1/d,k=1/m,p=1/f;return t.x=n[12],t.y=n[13],t.z=n[14],n[0]*=x,n[1]*=x,n[2]*=x,n[4]*=k,n[5]*=k,n[6]*=k,n[8]*=p,n[9]*=p,n[10]*=p,i.setFromRotationMatrix(this),n[0]=s,n[1]=a,n[2]=r,n[4]=h,n[5]=o,n[6]=u,n[8]=l,n[9]=c,n[10]=y,e.x=d,e.y=m,e.z=f,this}},{key:"makePerspective",value:function(t,i,e,n,s,a){var r=this.elements,h=2*s/(i-t),o=2*s/(e-n),u=(i+t)/(i-t),l=(e+n)/(e-n),c=-(a+s)/(a-s),y=-2*a*s/(a-s);return r[0]=h,r[4]=0,r[8]=u,r[12]=0,r[1]=0,r[5]=o,r[9]=l,r[13]=0,r[2]=0,r[6]=0,r[10]=c,r[14]=y,r[3]=0,r[7]=0,r[11]=-1,r[15]=0,this}},{key:"makeOrthographic",value:function(t,i,e,n,s,a){var r=this.elements,h=1/(i-t),o=1/(e-n),u=1/(a-s),l=(i+t)*h,c=(e+n)*o,y=(a+s)*u;return r[0]=2*h,r[4]=0,r[8]=0,r[12]=-l,r[1]=0,r[5]=2*o,r[9]=0,r[13]=-c,r[2]=0,r[6]=0,r[10]=-2*u,r[14]=-y,r[3]=0,r[7]=0,r[11]=0,r[15]=1,this}},{key:"equals",value:function(t){var i=this.elements,e=t.elements,n=!0,s=void 0;for(s=0;n&&s<16;++s)i[s]!==e[s]&&(n=!1);return n}}]),t}(),_=[new f,new f,new f,new f],R=(function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f;o(this,e),this.origin=t,this.direction=i}i(e,[{key:"set",value:function(t,i){return this.origin.copy(t),this.direction.copy(i),this}},{key:"copy",value:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"at",value:function(t){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f).copy(this.direction).multiplyScalar(t).add(this.origin)}},{key:"lookAt",value:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this}},{key:"recast",value:function(t){return this.origin.copy(this.at(t,_[0])),this}},{key:"closestPointToPoint",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f,e=i.subVectors(t,this.origin).dot(this.direction);return 0<=e?i.copy(this.direction).multiplyScalar(e).add(this.origin):i.copy(this.origin)}},{key:"distanceSquaredToPoint",value:function(t){var i=_[0].subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):_[0].copy(this.direction).multiplyScalar(i).add(this.origin).distanceToSquared(t)}},{key:"distanceToPoint",value:function(t){return Math.sqrt(this.distanceSquaredToPoint(t))}},{key:"distanceToPlane",value:function(t){var i=t.normal.dot(this.direction),e=0!==i?-(this.origin.dot(t.normal)+t.constant)/i:0===t.distanceToPoint(this.origin)?0:-1;return 0<=e?e:null}},{key:"distanceSquaredToSegment",value:function(t,i,e,n){var s=_[0].copy(t).add(i).multiplyScalar(.5),a=_[1].copy(i).sub(t).normalize(),r=_[2].copy(this.origin).sub(s),h=.5*t.distanceTo(i),o=-this.direction.dot(a),u=r.dot(this.direction),l=-r.dot(a),c=r.lengthSq(),y=Math.abs(1-o*o),v=void 0,d=void 0,m=void 0,f=void 0,x=void 0;return 0<y?(d=o*u-l,m=h*y,0<=(v=o*l-u)?-m<=d?d<=m?x=(v*=f=1/y)*(v+o*(d*=f)+2*u)+d*(o*v+d+2*l)+c:(d=h,x=-(v=Math.max(0,-(o*d+u)))*v+d*(d+2*l)+c):(d=-h,x=-(v=Math.max(0,-(o*d+u)))*v+d*(d+2*l)+c):d<=-m?x=-(v=Math.max(0,-(-o*h+u)))*v+(d=0<v?-h:Math.min(Math.max(-h,-l),h))*(d+2*l)+c:d<=m?(v=0,x=(d=Math.min(Math.max(-h,-l),h))*(d+2*l)+c):x=-(v=Math.max(0,-(o*h+u)))*v+(d=0<v?h:Math.min(Math.max(-h,-l),h))*(d+2*l)+c):(d=0<o?-h:h,x=-(v=Math.max(0,-(o*d+u)))*v+d*(d+2*l)+c),void 0!==e&&e.copy(this.direction).multiplyScalar(v).add(this.origin),void 0!==n&&n.copy(a).multiplyScalar(d).add(s),x}},{key:"intersectSphere",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f,e=_[0].subVectors(t.center,this.origin),n=e.dot(this.direction),s=e.dot(e)-n*n,a=t.radius*t.radius,r=null,h=void 0,o=void 0,u=void 0;return s<=a&&(u=n+(h=Math.sqrt(a-s)),(0<=(o=n-h)||0<=u)&&(r=o<0?this.at(u,i):this.at(o,i))),r}},{key:"intersectsSphere",value:function(t){return this.distanceToPoint(t.center)<=t.radius}},{key:"intersectPlane",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f,e=this.distanceToPlane(t);return null===e?null:this.at(e,i)}},{key:"intersectsPlane",value:function(t){var i=t.distanceToPoint(this.origin);return 0===i||t.normal.dot(this.direction)*i<0}},{key:"intersectBox",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new f,e=this.origin,n=this.direction,s=t.min,a=t.max,r=1/n.x,h=1/n.y,o=1/n.z,u=null,l=void 0,c=void 0,y=void 0,v=void 0,d=void 0,m=void 0;return 0<=r?(l=(s.x-e.x)*r,c=(a.x-e.x)*r):(l=(a.x-e.x)*r,c=(s.x-e.x)*r),0<=h?(y=(s.y-e.y)*h,v=(a.y-e.y)*h):(y=(a.y-e.y)*h,v=(s.y-e.y)*h),l<=v&&y<=c&&((l<y||l!=l)&&(l=y),(v<c||c!=c)&&(c=v),0<=o?(d=(s.z-e.z)*o,m=(a.z-e.z)*o):(d=(a.z-e.z)*o,m=(s.z-e.z)*o),l<=m&&d<=c&&((l<d||l!=l)&&(l=d),(m<c||c!=c)&&(c=m),0<=c&&(u=this.at(0<=l?l:c,i)))),u}},{key:"intersectsBox",value:function(t){return null!==this.intersectBox(t,_[0])}},{key:"intersectTriangle",value:function(t,i,e,n,s){var a=this.direction,r=_[0],h=_[1],o=_[2],u=_[3],l=null,c=void 0,y=void 0,v=void 0,d=void 0,m=void 0;return h.subVectors(i,t),o.subVectors(e,t),u.crossVectors(h,o),0===(c=a.dot(u))||n&&0<c||(0<c?y=1:(y=-1,c=-c),r.subVectors(this.origin,t),0<=(v=y*a.dot(o.crossVectors(r,o)))&&0<=(d=y*a.dot(h.cross(r)))&&v+d<=c&&0<=(m=-y*r.dot(u))&&(l=this.at(m/c,s))),l}},{key:"applyMatrix4",value:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}},{key:"equals",value:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}])}(),function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,n),this.radius=t,this.phi=i,this.theta=e}return i(n,[{key:"set",value:function(t,i,e){return this.radius=t,this.phi=i,this.theta=e,this}},{key:"copy",value:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"setFromVector3",value:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Math.min(Math.max(t.y/this.radius,-1),1))),this.makeSafe()}},{key:"makeSafe",value:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}}]),n}()),B=(function(){function t(){o(this,t),this.elements=new Float32Array([1,0,0,1,0,1])}i(t,[{key:"set",value:function(t,i,e,n,s,a){var r=this.elements;return r[0]=t,r[1]=i,r[3]=n,r[2]=e,r[4]=s,r[5]=a,this}},{key:"identity",value:function(){return this.set(1,0,0,1,0,1),this}},{key:"copy",value:function(t){var i=t.elements;return this.set(i[0],i[1],i[2],i[3],i[4],i[5]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toMatrix3",value:function(t){var i=t.elements;t.set(i[0],i[1],i[2],i[1],i[3],i[4],i[2],i[4],i[5])}},{key:"add",value:function(t){var i=this.elements,e=t.elements;return i[0]+=e[0],i[1]+=e[1],i[3]+=e[3],i[2]+=e[2],i[4]+=e[4],i[5]+=e[5],this}},{key:"norm",value:function(){var t=this.elements,i=t[1]*t[1],e=t[2]*t[2],n=t[4]*t[4];return Math.sqrt(t[0]*t[0]+i+e+i+t[3]*t[3]+n+e+n+t[5]*t[5])}},{key:"off",value:function(){var t=this.elements;return Math.sqrt(2*(t[1]*t[1]+t[2]*t[2]+t[4]*t[4]))}},{key:"applyToVector3",value:function(t){var i=t.x,e=t.y,n=t.z,s=this.elements;return t.x=s[0]*i+s[1]*e+s[2]*n,t.y=s[1]*i+s[3]*e+s[4]*n,t.z=s[2]*i+s[4]*e+s[5]*n,t}},{key:"equals",value:function(t){var i=this.elements,e=t.elements,n=!0,s=void 0;for(s=0;n&&s<6;++s)i[s]!==e[s]&&(n=!1);return n}}],[{key:"calculateIndex",value:function(t,i){return 3-(3-t)*(2-t)/2+i}}])}(),function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;o(this,s),this.x=t,this.y=i,this.z=e,this.w=n}i(s,[{key:"set",value:function(t,i,e,n){return this.x=t,this.y=i,this.z=e,this.w=n,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t}},{key:"setAxisAngleFromQuaternion",value:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this}},{key:"setAxisAngleFromRotationMatrix",value:function(t){var i=t.elements,e=i[0],n=i[4],s=i[8],a=i[1],r=i[5],h=i[9],o=i[2],u=i[6],l=i[10],c=void 0,y=void 0,v=void 0,d=void 0,m=void 0,f=void 0,x=void 0,k=void 0,p=void 0,g=void 0,M=void 0;return Math.abs(n-a)<.01&&Math.abs(s-o)<.01&&Math.abs(h-u)<.01?Math.abs(n+a)<.1&&Math.abs(s+o)<.1&&Math.abs(h+u)<.1&&Math.abs(e+r+l-3)<.1?this.set(1,0,0,0):(c=Math.PI,x=(l+1)/2,k=(n+a)/4,p=(s+o)/4,g=(h+u)/4,(f=(r+1)/2)<(m=(e+1)/2)&&x<m?m<.01?(y=0,d=v=.707106781):(v=k/(y=Math.sqrt(m)),d=p/y):x<f?f<.01?(v=0,d=y=.707106781):(y=k/(v=Math.sqrt(f)),d=g/v):x<.01?(v=y=.707106781,d=0):(y=p/(d=Math.sqrt(x)),v=g/d),this.set(y,v,d,c)):(M=Math.sqrt((u-h)*(u-h)+(s-o)*(s-o)+(a-n)*(a-n)),Math.abs(M)<.001&&(M=1),this.x=(u-h)/M,this.y=(s-o)/M,this.z=(a-n)/M,this.w=Math.acos((e+r+l-1)/2)),this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"multiplyVectors",value:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this.w=t.w*i.w,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}},{key:"divideScalar",value:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this}},{key:"applyMatrix4",value:function(t){var i=this.x,e=this.y,n=this.z,s=this.w,a=t.elements;return this.x=a[0]*i+a[4]*e+a[8]*n+a[12]*s,this.y=a[1]*i+a[5]*e+a[9]*n+a[13]*s,this.z=a[2]*i+a[6]*e+a[10]*n+a[14]*s,this.w=a[3]*i+a[7]*e+a[11]*n+a[15]*s,this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,e=this.y-t.y,n=this.z-t.z,s=this.w-t.w;return i*i+e*e+n*n+s*s}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this}},{key:"lerpVectors",value:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}}])}(),{MAIN:0,AUXILIARY:1,SECONDARY:2}),N=2*Math.PI,I=new f,U=new C,W=function(){function s(t,i,e,n){o(this,s),this.position=t,this.quaternion=i,this.target=e,this.settings=n,this.spherical=new R}return i(s,[{key:"setPosition",value:function(t){return this.position=t,this}},{key:"setQuaternion",value:function(t){return this.quaternion=t,this}},{key:"setTarget",value:function(t){return this.target=t,this}},{key:"updateQuaternion",value:function(){var t=this.settings,i=t.rotation;return t.general.orbit?U.lookAt(I.subVectors(this.position,this.target),i.pivotOffset,i.up):U.lookAt(I.set(0,0,0),this.target.setFromSpherical(this.spherical),i.up),this.quaternion.setFromRotationMatrix(U),this}},{key:"adjustSpherical",value:function(t,i){var e=this.settings,n=e.general.orbit,s=e.rotation,a=this.spherical;return a.theta=s.invertX?a.theta+t:a.theta-t,a.phi=!n&&!s.invertY||n&&s.invertY?a.phi+i:a.phi-i,a.theta=Math.min(Math.max(a.theta,s.minAzimuthalAngle),s.maxAzimuthalAngle),a.phi=Math.min(Math.max(a.phi,s.minPolarAngle),s.maxPolarAngle),a.theta%=N,a.makeSafe(),n&&this.position.setFromSpherical(a).add(this.target),this}},{key:"zoom",value:function(t){var i=this.settings,e=i.general,n=i.sensitivity,s=i.zoom,a=this.spherical,r=void 0,h=void 0,o=void 0;return e.orbit&&s.enabled&&(r=t*n.zoom,s.invert&&(r=-r),h=Math.max(s.minDistance,1e-6),o=Math.min(s.maxDistance,1/0),a.radius=Math.min(Math.max(a.radius+r,h),o),this.position.setFromSpherical(a).add(this.target)),this}},{key:"update",value:function(t){}},{key:"lookAt",value:function(t){var i=this.spherical,e=this.position,n=this.target;return n.copy(t),this.settings.general.orbit?I.subVectors(e,n):I.subVectors(n,e).normalize(),i.setFromVector3(I),i.radius=Math.max(i.radius,1e-6),this.updateQuaternion(),this}},{key:"getViewDirection",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f;return t.setFromSpherical(this.spherical).normalize(),this.settings.general.orbit&&t.negate(),t}}]),s}(),Q=function(){function t(){o(this,t),this.left=!1,this.right=!1,this.forward=!1,this.backward=!1,this.up=!1,this.down=!1}return i(t,[{key:"reset",value:function(){return this.left=!1,this.right=!1,this.forward=!1,this.backward=!1,this.up=!1,this.down=!1,this}}]),t}(),Y=new f(1,0,0),X=new f(0,1,0),K=new f(0,0,1),j=new f,G=function(){function s(t,i,e,n){o(this,s),this.position=t,this.quaternion=i,this.target=e,this.settings=n,this.movementState=new Q}return i(s,[{key:"setPosition",value:function(t){return this.position=t,this}},{key:"setQuaternion",value:function(t){return this.quaternion=t,this}},{key:"setTarget",value:function(t){return this.target=t,this}},{key:"translateOnAxis",value:function(t,i){j.copy(t).applyQuaternion(this.quaternion).multiplyScalar(i),this.position.add(j),this.settings.general.orbit&&this.target.add(j)}},{key:"translate",value:function(t){var i=this.settings.sensitivity,e=this.movementState,n=t*i.translation;e.backward?this.translateOnAxis(K,n):e.forward&&this.translateOnAxis(K,-n),e.right?this.translateOnAxis(Y,n):e.left&&this.translateOnAxis(Y,-n),e.up?this.translateOnAxis(X,n):e.down&&this.translateOnAxis(X,-n)}},{key:"update",value:function(t){this.settings.translation.enabled&&this.translate(t)}},{key:"moveTo",value:function(t){return this.settings.general.orbit?this.target.copy(t):this.position.copy(t),this}}]),s}(),H=new Proxy({BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,META_LEFT:91,META_RIGHT:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL_POINT:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,EQUAL_SIGN:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},{get:function(t,i){return i in t?t[i]:1===i.length?i.toUpperCase().charCodeAt(0):void 0}}),Z=function(){function t(){o(this,t),this.orbit=!0}return i(t,[{key:"copy",value:function(t){return this.orbit=t.orbit,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),J=function(){function t(){o(this,t),this.defaultActions=new Map,this.actions=new Map}return i(t,[{key:"reset",value:function(){return this.actions=new Map(this.defaultActions),this}},{key:"setDefault",value:function(t){return this.defaultActions=t,this.reset()}},{key:"copy",value:function(t){return this.defaultActions=new Map(t.defaultActions),this.actions=new Map(t.actions),this}},{key:"clearDefault",value:function(){return this.defaultActions.clear(),this}},{key:"clear",value:function(){return this.actions.clear(),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"has",value:function(t){return this.actions.has(t)}},{key:"get",value:function(t){return this.actions.get(t)}},{key:"set",value:function(t,i){return this.actions.set(t,i),this}},{key:"delete",value:function(t){return this.actions.delete(t)}},{key:"toJSON",value:function(){return{defaultActions:[].concat(n(this.defaultActions)),actions:[].concat(n(this.actions))}}}]),t}(),$=function(){function t(){o(this,t),this.hold=!1,this.lock=!0}return i(t,[{key:"copy",value:function(t){return this.hold=t.hold,this.lock=t.lock,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),tt=function(){function t(){o(this,t),this.up=new f,this.up.copy(X),this.pivotOffset=new f,this.minAzimuthalAngle=-1/0,this.maxAzimuthalAngle=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.invertX=!1,this.invertY=!1}return i(t,[{key:"copy",value:function(t){return this.up.copy(t.up),this.pivotOffset.copy(t.pivotOffset),this.minAzimuthalAngle=null!==t.minAzimuthalAngle?t.minAzimuthalAngle:-1/0,this.maxAzimuthalAngle=null!==t.maxAzimuthalAngle?t.maxAzimuthalAngle:1/0,this.minPolarAngle=t.minPolarAngle,this.maxPolarAngle=t.maxPolarAngle,this.invertX=t.invertX,this.invertY=t.invertY,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),it=function(){function t(){o(this,t),this.rotation=.0025,this.translation=1,this.zoom=.1}return i(t,[{key:"copy",value:function(t){return this.rotation=t.rotation,this.translation=t.translation,this.zoom=t.zoom,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),et=function(){function t(){o(this,t),this.enabled=!0}return i(t,[{key:"copy",value:function(t){return this.enabled=t.enabled,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),nt=function(){function t(){o(this,t),this.enabled=!0,this.invert=!1,this.minDistance=1e-6,this.maxDistance=1/0}return i(t,[{key:"copy",value:function(t){return this.enabled=t.enabled,this.invert=t.invert,this.minDistance=t.minDistance,this.maxDistance=t.maxDistance,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),st=function(){function t(){o(this,t),this.general=new Z,this.keyBindings=new J,this.keyBindings.setDefault(new Map([[H.W,h.MOVE_FORWARD],[H.UP,h.MOVE_FORWARD],[H.A,h.MOVE_LEFT],[H.LEFT,h.MOVE_LEFT],[H.S,h.MOVE_BACKWARD],[H.DOWN,h.MOVE_BACKWARD],[H.D,h.MOVE_RIGHT],[H.RIGHT,h.MOVE_RIGHT],[H.X,h.MOVE_DOWN],[H.SPACE,h.MOVE_UP],[H.PAGE_DOWN,h.ZOOM_OUT],[H.PAGE_UP,h.ZOOM_IN]])),this.pointer=new $,this.rotation=new tt,this.sensitivity=new it,this.translation=new et,this.zoom=new nt}return i(t,[{key:"copy",value:function(t){return this.general.copy(t.general),this.keyBindings.copy(t.keyBindings),this.pointer.copy(t.pointer),this.rotation.copy(t.rotation),this.sensitivity.copy(t.sensitivity),this.translation.copy(t.translation),this.zoom.copy(t.zoom),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toDataURL",value:function(){return URL.createObjectURL(new Blob([JSON.stringify(this)],{type:"text/json"}))}}]),t}(),at=function(){function t(){o(this,t)}return i(t,[{key:"execute",value:function(t){throw new Error("Strategy#execute method not implemented!")}}]),t}(),rt=function(t){function n(t,i){o(this,n);var e=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.movementState=t,e.direction=i,e}return e(n,at),i(n,[{key:"execute",value:function(t){var i=this.movementState;switch(this.direction){case ht.FORWARD:i.forward=t;break;case ht.LEFT:i.left=t;break;case ht.BACKWARD:i.backward=t;break;case ht.RIGHT:i.right=t;break;case ht.DOWN:i.down=t;break;case ht.UP:i.up=t}}}]),n}(),ht={FORWARD:0,LEFT:1,BACKWARD:2,RIGHT:3,DOWN:4,UP:5},ot=function(t){function n(t,i){o(this,n);var e=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.rotationManager=t,e.zoomIn=i,e}return e(n,at),i(n,[{key:"execute",value:function(t){t&&this.rotationManager.zoom(this.zoomIn?-1:1)}}]),n}(),ut=function(){function r(){var t,i,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:document.body;o(this,r),this.dom=a,this.position=n,this.quaternion=s,this.target=new f,this.settings=new st,this.rotationManager=new W(n,s,this.target,this.settings),this.translationManager=new G(n,s,this.target,this.settings),this.strategies=(t=this.rotationManager,i=this.translationManager,e=i.movementState,new Map([[h.MOVE_FORWARD,new rt(e,ht.FORWARD)],[h.MOVE_LEFT,new rt(e,ht.LEFT)],[h.MOVE_BACKWARD,new rt(e,ht.BACKWARD)],[h.MOVE_RIGHT,new rt(e,ht.RIGHT)],[h.MOVE_DOWN,new rt(e,ht.DOWN)],[h.MOVE_UP,new rt(e,ht.UP)],[h.ZOOM_OUT,new ot(t,!1)],[h.ZOOM_IN,new ot(t,!0)]])),this.lastScreenPosition=new c,this.dragging=!1,this.enabled=!1,null!==n&&null!==s&&(this.lookAt(this.target),null!==a&&this.setEnabled())}return i(r,[{key:"getDom",value:function(){return this.dom}},{key:"getPosition",value:function(){return this.position}},{key:"getQuaternion",value:function(){return this.quaternion}},{key:"getTarget",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f;return t.copy(this.target),this.settings.general.orbit||t.add(this.position),t}},{key:"getViewDirection",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new f;return this.rotationManager.getViewDirection(t)}},{key:"setDom",value:function(t){var i=this.enabled;return null!==t&&(i&&this.setEnabled(!1),this.dom=t,this.setEnabled(i)),this}},{key:"setPosition",value:function(t){return this.position=t,this.rotationManager.setPosition(t),this.translationManager.setPosition(t),this.lookAt(this.target)}},{key:"setQuaternion",value:function(t){return this.quaternion=t,this.rotationManager.setQuaternion(t),this.translationManager.setQuaternion(t),this.lookAt(this.target)}},{key:"setTarget",value:function(t){return this.target=t,this.rotationManager.setTarget(t),this.translationManager.setTarget(t),this.lookAt(this.target)}},{key:"setOrbitEnabled",value:function(t){var i=this.settings.general;return i.orbit!==t&&(this.getTarget(this.target),i.orbit=t,this.lookAt(this.target)),this}},{key:"copy",value:function(t){return this.dom=t.getDom(),this.position=t.getPosition(),this.quaternion=t.getQuaternion(),this.target=t.getTarget(),this.settings.copy(t.settings),this.rotationManager.setPosition(this.position).setQuaternion(this.quaternion).setTarget(this.target),this.translationManager.setPosition(this.position).setQuaternion(this.quaternion).setTarget(this.target),this.lookAt(this.target)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"handlePointerMoveEvent",value:function(t){var i=this.settings,e=i.pointer,n=i.sensitivity,s=this.rotationManager,a=this.lastScreenPosition,r=void 0,h=void 0;document.pointerLockElement===this.dom?e.hold&&!this.dragging||s.adjustSpherical(t.movementX*n.rotation,t.movementY*n.rotation).updateQuaternion():(r=t.screenX-a.x,h=t.screenY-a.y,a.set(t.screenX,t.screenY),s.adjustSpherical(r*n.rotation,h*n.rotation).updateQuaternion())}},{key:"handleTouchMoveEvent",value:function(t){var i=this.settings.sensitivity,e=this.rotationManager,n=this.lastScreenPosition,s=t.touches[0],a=s.screenX-n.x,r=s.screenY-n.y;n.set(s.screenX,s.screenY),t.preventDefault(),e.adjustSpherical(a*i.rotation,r*i.rotation).updateQuaternion()}},{key:"handleMainPointerButton",value:function(t,i){this.dragging=i,this.settings.pointer.lock?this.setPointerLocked():i?(this.lastScreenPosition.set(t.screenX,t.screenY),this.dom.addEventListener("mousemove",this)):this.dom.removeEventListener("mousemove",this)}},{key:"handleAuxiliaryPointerButton",value:function(t,i){}},{key:"handleSecondaryPointerButton",value:function(t,i){}},{key:"handlePointerButtonEvent",value:function(t,i){switch(t.preventDefault(),t.button){case B.MAIN:this.handleMainPointerButton(t,i);break;case B.AUXILIARY:this.handleAuxiliaryPointerButton(t,i);break;case B.SECONDARY:this.handleSecondaryPointerButton(t,i)}}},{key:"handleTouchEvent",value:function(t,i){var e=t.touches[0];t.preventDefault(),i?(this.lastScreenPosition.set(e.screenX,e.screenY),this.dom.addEventListener("touchmove",this)):this.dom.removeEventListener("touchmove",this)}},{key:"handleKeyboardEvent",value:function(t,i){var e=this.settings.keyBindings;e.has(t.keyCode)&&(t.preventDefault(),this.strategies.get(e.get(t.keyCode)).execute(i))}},{key:"handleWheelEvent",value:function(t){this.rotationManager.zoom(Math.sign(t.deltaY))}},{key:"handlePointerLockEvent",value:function(){document.pointerLockElement===this.dom?this.dom.addEventListener("mousemove",this):this.dom.removeEventListener("mousemove",this)}},{key:"handleEvent",value:function(t){switch(t.type){case"mousemove":this.handlePointerMoveEvent(t);break;case"touchmove":this.handleTouchMoveEvent(t);break;case"mousedown":this.handlePointerButtonEvent(t,!0);break;case"mouseup":this.handlePointerButtonEvent(t,!1);break;case"touchstart":this.handleTouchEvent(t,!0);break;case"touchend":this.handleTouchEvent(t,!1);break;case"keydown":this.handleKeyboardEvent(t,!0);break;case"keyup":this.handleKeyboardEvent(t,!1);break;case"wheel":this.handleWheelEvent(t);break;case"pointerlockchange":this.handlePointerLockEvent()}}},{key:"update",value:function(t){this.rotationManager.update(t),this.translationManager.update(t)}},{key:"moveTo",value:function(t){return this.rotationManager.moveTo(t),this}},{key:"lookAt",value:function(t){return this.rotationManager.lookAt(t),this}},{key:"setPointerLocked",value:function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?document.pointerLockElement!==this.dom&&void 0!==this.dom.requestPointerLock&&this.dom.requestPointerLock():void 0!==document.exitPointerLock&&document.exitPointerLock()}},{key:"setEnabled",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],i=this.dom;return this.translationManager.movementState.reset(),t&&!this.enabled?(document.addEventListener("pointerlockchange",this),document.body.addEventListener("keyup",this),document.body.addEventListener("keydown",this),i.addEventListener("mousedown",this),i.addEventListener("mouseup",this),i.addEventListener("touchstart",this),i.addEventListener("touchend",this),i.addEventListener("wheel",this)):!t&&this.enabled&&(document.removeEventListener("pointerlockchange",this),document.body.removeEventListener("keyup",this),document.body.removeEventListener("keydown",this),i.removeEventListener("mousedown",this),i.removeEventListener("mouseup",this),i.removeEventListener("touchstart",this),i.removeEventListener("touchend",this),i.removeEventListener("wheel",this),i.removeEventListener("mousemove",this),i.removeEventListener("touchmove",this)),this.setPointerLocked(!1),this.enabled=t,this}},{key:"dispose",value:function(){this.setEnabled(!1)}}]),r}();t.Action=h,t.DeltaControls=ut,t.KeyCode=H,t.PointerButton=B,t.MovementState=Q,t.RotationManager=W,t.TranslationManager=G,t.GeneralSettings=Z,t.KeyBindings=J,t.PointerSettings=$,t.RotationSettings=tt,t.SensitivitySettings=it,t.TranslationSettings=et,t.Settings=st,t.ZoomSettings=nt,t.Direction=ht,t.MovementStrategy=rt,t.Strategy=at,t.ZoomStrategy=ot,Object.defineProperty(t,"__esModule",{value:!0})});